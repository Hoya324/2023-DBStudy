# CHAPTER 02 관계 데이터 모델

## 01 관계 데이터 모델의 개념

### 1. 릴레이션
- 행과 열로 구성된 테이블

### 관계 relationship
1. 릴레이션 내에서 생성되는 관계
   - **릴레이션 내 데이터들의 관게**로 관련 있는 실제 데이터들의 집합으로 이루어진다.
2. 릴레이션 간에 생성되는 관계
   - **릴레이션 간의 관계**로 한 릴레이션에서 다른 릴레이션으로 식별 가능한 값을 이용하여 연결한다.

---

### 2. 릴레이션 스키마와 인스턴스
- 릴레이션은 스키마와 인스턴스로 이루어진다.

### 스키마
- 관계 데이터베이스의 릴레이션이 어떻게 구성되는지 어떤 정보를 담고 있는 지에 대한 기본적인 구조를 정의

### 인스턴스
- 테이블에 실제로 저장되는 데이터의 집합

### 릴레이션 스키마
- 릴레이션에 어떤 정보가 담길지를 정의
- 속성 : 릴레이션 스키마의 열
- 도메인 : 속성이 가질 수 있는 값의 집합
- 차수 : 속성의 개수

### 릴레이션 인스턴스
- 릴레이션 스키마에 실제로 저장된 데이터의 집합
- 투플 : 릴레이션의 행
- Cardinality : 투플의 수

| 릴레이션 용어 | 같은 의미로 통용되는 언어 | 파일 시스템 용어 |
| --- | --- | --- |
| 릴레이션 | 테이블 | 파일 |
| 스키마 | 내포 | 헤더 |
| 인스턴스 | 외연 | 데이터 |
| 투플 | 행 | 레코드 |
| 속성 | 열 | 필드 |

---

### 3. 릴레이션의 특징
1. 속성은 단일 값을 가진다.
2. 속성은 서로 다른 이름을 가진다.
3. 한 속성의 값은 모두 같은 도메인 값을 가진다.
4. 속성의 순서는 상관없다.
5. 릴레이션 내의 중복된 투플은 허용하지 않는다.
6. 투플의 순서는 상관없다.

### 릴레이션 생성 및 변경에 관한 SQL명령어
- CREATE TABLE : 데이터를 저장하기 위한 테이블의 구조를 정의
- INSERT : 생성된 테이블에 데이터
- DLELETE : 테이블에 저장된 테이블을 삭제
- UPDATE : 테이블에 저장된 데이터를 수정
- SELECT : 테이블에 저장된 테이블을 검색

---

### 4. 관계 데이터 모델
- 데이터를 2치원 테이블의 형태인 릴레이션으로 표현하며, 릴레이션에 대한 제약조건과 관계 연산을 위한 관계대수를 정의한다.
- 제약 조건 : 각 릴레이션에 저장된 데이터 값이 가져야하는 제약
- 관계 연산 : 릴레이션을 다루는 연산 규칙

---
## 02 무결성 제약조건

### 1. 키
- 릴레이션에서 특정 투플을 식별할 때 사용하는 속성 혹은 속성의 집합
- 키가 되는 속성은 반드시 값이 달라 투플(행)들을 서로 구별할 수 있어야 한다.

### super key
- 투플을 유일하게 식별할 수 있는 하나의 속성 혹은 속성의 집합
  <br> ex) 고객번호, 주빈번호

### candidate key
- 투플(행)을 유일하게 식별할 수 있는 속성의 최소 집합
  <br>+) 두 개 이상의 속성으로 이루어진 키를 composite key라 함.

### primary key
- 여러 candidate key 중 하나를 선정하여 대표로 삼는 키
- 릴레이션의 특성을 반영하여 선택
- 기본키 특성
  - 릴레이션 내 투플을 식별할 수 있는 고유한 값을 가져야 한다.
  - NULL값은 허용하지 않는다.
  - 키값의 변동이 일어나지 않아야 한다.
  - 최대한 적은 수의 속성을 가진 것이어야 한다.
  - 키를 사용하는 데 있어서 문제 발생 소지가 없어야 한다.

### 대리키
- surrogate key / artificial key라고도 함
- DBMS나 관련 소프트웨어에서 임의로 생성하는 값으로 사용자가 직관적으로 그 값의 의미를 알 수 없다.

### alternate key
- 기본키로 선정되지 않은 후보키

### foreign key
- foreign key는 다른 릴레이션의 primary key를 참조하는 속성을 말한다.
- 외래키는(foreign key) 다른 릴레이션의 기본키(primary key)를 참조하여 관계 데이터 모델의 특징인 릴레이션 간의 관계(relationship)를 표현한다.
- foreign key의 특성
  - 릴레이션의 기본키와 달리 NULL 값을 포함할 수 있다.
  - 중복값도 허용한다.
  - 참조하고 참조되는 양쪽 릴레이션의 도메인이 서로 같아야한다.
  - 데이터의 일관성을 유지해야한다.
  - 외래키 사용시 참조하는 릴레이션이 꼭 다른 릴레이션일 필요가 없다. 자기 자신이 자신의 기본키를 외래키로 사용할 수 있다.
  - 다른 릴레이션의 기본키를 참조하는 속성이다.
  - 외래키가 기본키의 일부가 될 수 있다.

### 무결성 제약조건
- 데이터베이스에 저장된 데이터의 일관성과 정확성을 지키는 것
- 도메인 무결성 제약조건
- 개체 무결성 제약조건
- 참조 무결성 제약조건

### 도메인 무결성 제약조건
- 릴레이션 내의 투플들이 각 속성의 도메인에 지정된 값만을 가져야 한다는 조건

### 개체 무결성 제약조건
- 기본키는 NULL값을 가져서는 안된다.
- 기본키는 릴레이션 내에 오직 하나의 값만 존재한다.

### 참조 무결성
- 릴레이션 간의 참조 관계를 선언하는 제약조건
- 자식 릴레이션의 외래키는 부모 릴레이션의 기본키와 도메인이 동일해야한다.

| 명령어 | 의미 |
| --- | --- |
| RESTRICTED | 자식 릴레이션에서 참조하고 있을 경우 부모 릴레이션의 삭제 작업을 거부함 |
| CASCADE | 자식 릴레이션의 관련 투플을 같이 삭제함 |
| DEFAULT | 자식 릴레이션의 관련 투플을 미리 설정해둔 값으로 변경 |
| NULL | 자식 릴레이션의 관련 투플을 NULL값으로 설정 |

---

## 03. 관계대수

- 관계대수: 어떤 데이터를 어떻게 찾는지에 대한 처리 절차를 명시하는 절차적인 언어

### 1. 관계대수
- 릴레이션 간 연산을 통해 결과 릴레이션을 찾는 절차를 기술한 언어

### 관계대수 연산자

- 연산자 : 피연산자에 적용되는 연산 기호

- 순수 관계 연산 : 셀렉션(selection), 프로젝션(projection), 조인(join), 디비전(division), 개명(rename)
- 일반 집합 연산 : 합집합(union), 차집합(difference), 교집합(intersection), 카티전 프로덕트(cartesian product)

### 관계대수식
- 관계대수 연산을 수행하기 위한 식

- 단항 연산자 : 연산자 릴레이션
- 이항 연산자 : 릴레이션1 연산자 릴레이션2

### 2. 셀렉션과 프로젝션
- 관계대수에서 가장 기본적인 연산으로 하나의 릴레이션을 대상으로 하는 단항 연산자이다.
  
### 셀렉션
- 투플을 추출하기 위한 연산이다.
- 릴레이션의 차수는 대상 릴레이션과 동일하고 카디날리티는 대상 릴레이샨보다 작거나 같음

### 프로젝션
- 릴레이션의 속성을 추출하기 위한 연산
- 릴레이션의 차수는 대상 릴레이션의 차수보다 작거나 같고 카디날리티는 동일

### 3. 집합 연산

합집합(union), 차집합(difference), 교집합(intersection), 카티전 프로덕트(cartesian product) 등이 있다. 집합 연산자는 두 개의 릴레이션을 대상으로 하는 이항 연산자 이다.

카티전 프로덕트를 제외하고는 두 릴레이션의 속성 수가 같고 순서도 같아야 하며 각각 동일한 도메인으로 대응되어야 한다.

### 카티전 프로덕트
- 두 릴레이션을 연결시켜 하나로 합칠 때 사용한다. 결과 릴레이션은 첫 번째 릴레이션의 오른쪽에 두 번째 릴레이션의 모든 투플을 순서대로 배열하여 반환한다.
- 릴레이션의 차수는 두 릴레이션의 차수의 합이며, 카디날리티는 두 릴레이션의 카디날리티의 곱이다.

### 4. 조인
- 두 릴레이션의 공통 속성을 기준으로 속성 값이 같은 투플을 수평으로 결합하는 연산이다.
- 두 릴레이션을 카디전 프로덕트 연산을 한 후 셀렉션 연산을 한 것
- 두 릴레이션의 조인에 참여하는 속성이 서로 동일한 도메인으로 구성되어야 한다. 
- 조인 연산의 결과는 공통 속성의 속성 값이 동일한 투플만을 반환한다.

### 세타조인과 동등조인
- 세타조인 : 조인에 참여하는 두 릴레이션의 속성 값을 비교하여 조건을 만족하는 투플만 반환한다. 세타조인의 조건은(=, ≠, <, >, <. >)중 하나가 된다.
- 동등조인 : 세타조인에서 = 연산자를 사용한 조인을 말한다. 보통 조인연산이라고 하면 동등조인을 지칭하는 것이다.

### 자연조인
- 동등조인의 결과 릴레이션은 첫 번째 릴레이션의 속성과 두 번째 릴레이션의 속성이 모두 나타남.
- 자연조인 : 동등조인에서 조인에 참여한 속성이 두 번 나오지 않도록 두 번째 속성을 제거한 결과를 반환한다.

### 외부조인과 세미조인
- 외부조인
  - 자연조인의 확장된 형태이다. 조인에 실패한 투플을 모두 보여주되 값이 없는 대응 속성에는 NULL값을 채워 반환한다.
  - 왼쪽 외부조인, 오른쪽 외부조인, 완전 외부조인으로 나뉜다.
- 세미조인
  - 자연조인을 한 후 두 릴레이션 중 한쪽 리레이션의 결과만 반환한다.

### 5. 디비전
- 디비전(division)
  - 릴레이션의 속성 값의 집합으로 연산을 수행한다.
  - 디비전 연산은 특정 값들을 모두 갖고 있는 투플을 찾을 때 사용한다.

